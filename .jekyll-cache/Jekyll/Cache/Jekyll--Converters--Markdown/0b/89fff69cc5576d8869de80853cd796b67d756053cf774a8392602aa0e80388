I"É <hr />

<blockquote>
  <p>ä¸Šå‘¨äº’è”ç½‘è¯¾ç¨‹ç»“è¯¾äº†ã€‚è™½ç„¶ä¸Šè¯¾åŸºæœ¬æ²¡å¬â€¦â€¦ä¸è¿‡è¿˜æ˜¯ç¨å¾®æ¥è§¦äº†ä¸€ç‚¹å‰ç«¯çš„çŸ¥è¯†ã€‚å°±æƒ³æ‰¾ç‚¹å°é¡¹ç›®ç»ƒç»ƒæ‰‹ï¼Œæ‰€ä»¥åˆšå¥½è¶ç€è¿™ä¸ªæœºä¼šèŠ±äº†ä¸€ä¸ªä¸‹åˆæŠŠå­¦æ ¡çš„å°çˆ±è¯¾ç¨‹è¡¨è¯¾ç¨‹å¯¼å…¥åŠŸèƒ½ç»™å®ç°äº†ï¼ˆå…¶å®å¯’å‡å°±æƒ³åšäº†ï¼Œå¯æƒœæ²¡(fei)æ—¶(chang)é—´(lan)å­¦è¿™äº›ä¸œè¥¿2333ï¼‰</p>
</blockquote>

<p>åºŸè¯ä¸å¤šè¯´ï¼Œè®°å½•ä¸€ä¸‹ä»£ç æ€è·¯å’Œå¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„å‘</p>

<hr />

<h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2>
<ul>
  <li>
    <p>å®˜æ–¹å¼€å‘æ–‡æ¡£
https://ldtu0m3md0.feishu.cn/docs/doccnhZPl8KnswEthRXUz8ivnhb#26bux2</p>
  </li>
  <li>
    <p>Cheerioå®˜æ–¹ç¿»è¯‘æ–‡æ¡£
 https://juejin.im/post/6844904135767097352</p>
  </li>
</ul>

<h2 id="æ•´ä½“æ€è·¯">æ•´ä½“æ€è·¯</h2>

<p>é€šè¿‡å®˜æ–¹æ–‡æ¡£ä»¥åŠå¼€å‘è€…å·¥å…·ï¼Œæ•´ä¸ªå¼€å‘è¿‡ç¨‹æˆ‘ä»¬åªéœ€è¦ç¼–è¾‘ä¸¤ä¸ªæ–‡ä»¶ï¼š</p>

<blockquote>
  <p><em>scheduleHtmlProvider.js</em></p>

  <p><em>scheduleHtmlPasrse.js</em></p>
</blockquote>

<p>Provider æ–‡ä»¶æ˜¯ç”¨äºè·å– html çš„å‡½æ•°ï¼Œå°†è·å–åˆ°åŒ…å«è¯¾ç¨‹è¡¨æ•°æ®çš„ html ä¼ ç»™ Parser è¿›è¡Œæ•°æ®å¤„ç†ï¼Œå°†è¯¾ç¨‹ä¿¡æ¯æå–å‡ºæ¥å¹¶å°è£…æˆå®˜æ–¹è¦æ±‚çš„æ•°æ®ç»“æ„åè¾“å‡ºå³å¯</p>

<h2 id="ä»£ç ">ä»£ç </h2>

<h3 id="provider">Provider</h3>

<pre><code class="language-JavaScript">function scheduleHtmlProvider(dom = document) {                        
   var info = dom.getElementById('ktlist')//æ‰¾åˆ°å­˜æ”¾è¯¾ç¨‹æ•°æ®çš„åŒºåŸŸ
   //console.log(info)
   return info.innerHTML
}
</code></pre>
<p>è¿™éƒ¨åˆ†æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œåœ¨ç½‘é¡µä¸­æ£€æŸ¥å…ƒç´ æŒ‘å‡ºè¯¾ç¨‹ä¿¡æ¯å¯¹åº”çš„åŒºåŸŸè¿”å›å³å¯
<img src="https://pic4.zhimg.com/80/v2-c3bdea452a80bac431b6eba8ce818123.png" alt="" /></p>

<p>è¿è¡Œå‡½æ•°åæˆªå–çš„ html ç‰‡æ®µä¼šä»¥å¼¹å‡ºçª—å£çš„å½¢å¼å±•ç°</p>

<p><img src="https://pic4.zhimg.com/80/v2-6122dccb06ace169ff5aed564d6107c0.png" alt="" />
æ²¡å¿…è¦å®Œç¾åœ°æŠŠè¯¾ç¨‹è¡¨å®Œç¾æŠ å‡ºæ¥ï¼ŒåŒ…å«åˆ°å…³é”®ä¿¡æ¯å°±è¡Œï¼Œä¸»è¦çš„å¤„ç†è¿˜æ˜¯è¦çœ‹ Parser å‡½æ•°</p>

<p>åœ¨è¿™é‡Œä¸€å®šè¦åæ§½ä¸€ä¸‹å­¦æ ¡çš„<strong>åƒåœ¾hubç³»ç»Ÿ</strong>ï¼ç”µè„‘ç«¯çš„ç½‘é¡µå’Œç§»åŠ¨ç«¯çš„ç½‘é¡µæä¾›çš„æ˜¯ä¸ä¸€æ ·çš„æ•°æ®æ ¼å¼ï¼
<img src="https://pic4.zhimg.com/80/v2-c9759da482aa22601dd251a70f8c1624.png" alt="" /></p>

<p>ç”µè„‘ç«¯çš„ç½‘é¡µå…ƒç´ é‡Œé¢åªæä¾›äº†è¯¾ç¨‹åç§°ï¼Œä»»è¯¾æ•™å¸ˆå’Œä¸Šè¯¾æ—¶é—´ï¼Œä¸€ä¸ªé¡µé¢é‡Œé¢æœ€å¤šä¹Ÿåªæœ‰ä¸€ä¸ªæœˆçš„è¯¾ç¨‹æ•°æ®ã€‚æ˜¾ç„¶è¿™å¹¶ä¸ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ã€‚æœ€åæ˜¯æˆ‘åœ¨æ‰‹æœºå¾®ä¿¡ä¸Šç™»å½•äº†å¾®æ ¡å›­æŠŠæŸ¥çœ‹è¯¾è¡¨é¡µé¢åœ¨æµè§ˆå™¨æ‰“å¼€å†æŠŠé“¾æ¥å‘åˆ°ç”µè„‘ä¸Šæ‰è§£å†³äº†æ•°æ®ä¸å…¨çš„é—®é¢˜ã€‚ã€‚ã€‚</p>

<p>ä¹Ÿå°±æ˜¯è¿™ä¸ªé—®é¢˜æµªè´¹äº†æˆ‘ä¸€å¤§åŠçš„æ—¶é—´ã€‚ã€‚ã€‚æœ‰è¢«æ°”åˆ°</p>

<h3 id="parser">Parser</h3>

<p>è¿™éƒ¨åˆ†ä»£ç æ¯”è¾ƒå…³é”®ï¼Œä¸è¿‡è®¤çœŸä¸€ç‚¹ï¼ŒæŒ‰ç…§å®˜æ–¹è¦æ±‚çš„æ•°æ®æ ¼å¼
ä¸€ä¸ª part ä¸€ä¸ª part æ¥æ·»åŠ å°±æ˜¯äº†</p>

<p>å…·ä½“çœ‹ä»£ç ï¼Œæ€è·¯éƒ½åœ¨æ³¨é‡Šé‡Œäº†</p>

<pre><code class="language-JavaScript">function scheduleHtmlParser(html) {
    let result = []
    let all_class = $('li')
    //console.log(all_class)
    for(let i = 0;i &lt; all_class.length;i++){
        
        //è¯¾ç¨‹
        let className = $(all_class[i]).find('strong').text()
        
        //ä»»è¯¾æ•™å¸ˆ
        let teacher = $($(all_class[i]).find('p')[0]).text()
        teacher = teacher.replace('ä»»è¯¾æ•™å¸ˆï¼š','')

        //æ‰¾åˆ°å­˜æ”¾å‘¨æ¬¡èŠ‚æ¬¡æ—¶é—´åœ°ç‚¹ç­‰æ•°æ®çš„è¡¨æ ¼åŒºåŸŸ
        let grid = $(all_class[i]).find('.grid.demo-grid')

        for(let j = 1;j&lt;grid.length;j++){//ä»1å¼€å§‹ï¼Œall_class[0]æ˜¯è¡¨å¤´æ ‡é¢˜
            let re = { sections: [], weeks: [] }
            re.name = className.replace(/^\s*|\s*$/g,"")//æ­£åˆ™åŒ¹é…å»é™¤å­—ç¬¦ä¸²ä¸¤å¤´ç©ºæ ¼
            re.teacher = teacher.replace(/^\s*|\s*$/g,"")
            //å‘¨æ¬¡
            let weekrange = $($(grid[j]).find('div')[0]).text().replace(/^\s*|\s*$/g,"")
            //å°† x-y æ ¼å¼è½¬æ¢æˆæŒ‰æ•°ç»„å½¢å¼
            let beginWeek = weekrange.split('-')[0]
            let endWeek = weekrange.split('-')[1]
            for(let k = Number(beginWeek);k &lt;= Number(endWeek);k++){
                re.weeks.push(k)
            }

            //æ˜ŸæœŸï¼ˆéœ€è¦æŠŠä¸­æ–‡è½¬æ¢æˆæ•°å­—ï¼‰
            let day = $($(grid[j]).find('div')[1]).text().replace(/^\s*|\s*$/g,"")
            //ç”¨åˆ°äº†switch-caseç»“æ„ï¼Œç®€å•ç²—æš´2333
            switch(day[2]){
                case 'ä¸€':
                    re.day = '1'
                    break;
                case 'äºŒ':
                    re.day = '2'
                    break;
                case 'ä¸‰':
                    re.day = '3'
                    break;
                case 'å››':
                    re.day = '4'
                    break;
                case 'äº”':
                    re.day = '5'
                    break;
                case 'å…­':
                    re.day = '6'
                    break;
                case 'æ—¥':
                    re.day = '7'
                    break;
              
            }
            //èŠ‚æ¬¡
            let section = $($(grid[j]).find('div')[2]).text().replace(/^\s*|\s*$/g,"")
            section = section.match(/[0-9]*-[0-9]*/)[0] //æ­£åˆ™è¡¨è¾¾å¼æå–å‡ºéœ€è¦çš„x-yæ ¼å¼
            //è¿™é‡Œçš„å¤„ç†å’Œä¸Šé¢å‘¨æ¬¡çš„ä¸€æ ·
            let beginSec = section.split('-')[0]
            let endSec = section.split('-')[1]
            for(let k = Number(beginSec);k &lt;= Number(endSec);k++){
                re.sections.push({ section: k })
            }

            //åœ°ç‚¹
            let position = $($(grid[j]).find('div')[3]).text().replace(/^\s*|\s*$/g,"")
            re.position = position

            
            //console.log(re)
            result.push(re)
        }
        
    }
    var sectionTimes = [
      {
        "section": 1,
        "startTime": '08:00',
        "endTime": '08:45'
      },
      {
        "section": 2,
        "startTime": '08:55',
        "endTime": '09:40'
      },
      {
        "section": 3,
        "startTime": '10:10',
        "endTime": '10:55'
      },
      {
        "section": 4,
        "startTime": '11:05',
        "endTime": '11:50'
      },
      {
        "section": 5,
        "startTime": '14:00',
        "endTime": '14:45'
      },
      {
        "section": 6,
        "startTime": '14:50',
        "endTime": '15:35'
      },
      {
        "section": 7,
        "startTime": '15:55',
        "endTime": '16:40'
      },
      {
        "section": 8,
        "startTime": '16:45',
        "endTime":'17:30'
      },
      {
        "section": 9,
        "startTime": '18:30',
        "endTime": '19:15'
      },
      {
        "section": 10,
        "startTime": '19:20',
        "endTime": '20:05'
      },
      {
        "section": 11,
        "startTime": '20:15',
        "endTime": '21:00'
      },
      {
        "section": 12,
        "startTime": '21:05',
        "endTime": '21:50'
      }
    ]

    return { courseInfos: result ,
            sectionTimes:sectionTimes}
}

</code></pre>

<p>è¿™é‡Œä¹Ÿæœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ï¼šParser å‡½æ•°é‡Œé¢ä¸èƒ½ä½¿ç”¨documentå’Œwindowå¯¹è±¡ï¼Œå› ä¸ºè¿™éƒ¨åˆ†æ˜¯åœ¨æœåŠ¡ç«¯è§£æçš„ã€‚</p>

<p>æ‰€ä»¥æˆ‘ä»¬å°±ä½¿ç”¨ Cheerio æ¥è§£æï¼Œè¿™é‡Œåªç”¨åˆ°äº†é€‰æ‹©å™¨å’Œä¸€ç‚¹éå†æ“ä½œï¼Œå’Œ jQuery çš„è¯­æ³•ä¹Ÿæ¯”è¾ƒç›¸ä¼¼ï¼Œå­¦èµ·æ¥è¿˜æ˜¯æŒºå¿«çš„ï¼ˆæŒ‡å¤šå†™é”™å‡ æ¬¡å°±çŸ¥é“æ€ä¹ˆç”¨äº†ï¼‰ã€‚</p>

<p>ç­‰ä»£ç å…¨éƒ¨è°ƒè¯•æ­£ç¡®åï¼Œconsole æ§åˆ¶å°ä¼šæç¤º <code class="language-plaintext highlighter-rouge">All run successfully</code>
<img src="https://pic4.zhimg.com/80/v2-1c487ac0ac196f338a4be807f7a96816.png" alt="" /></p>

<p>åŒæ—¶ä¹Ÿä¼šå¼¹å‡ºçª—å£è¿”å›è·å–åˆ°çš„æ ¼å¼åŒ–åçš„è¯¾ç¨‹æ•°æ®</p>

<p><img src="https://pic4.zhimg.com/80/v2-8dd2aa00cc3270cfd6e0ff311e6697ac.png" alt="" /></p>

<p>è¿™æ—¶å€™å°±å¯ä»¥ä¸Šä¼ åˆ°äº‘ç«¯è¿›è¡Œ E2E è‡ªæµ‹äº†</p>

<h2 id="æµ‹è¯•">æµ‹è¯•</h2>

<p>åœ¨æ‰‹æœºç«¯æ‰“å¼€å°çˆ±è¯¾ç¨‹è¡¨ï¼Œæœç´¢å­¦æ ¡ï¼Œç‚¹å‡»è‡ªå·±æäº¤çš„é€‚é…
<img src="https://pic4.zhimg.com/80/v2-ffb90f75c7898094ea4c9ee14956a0da.png" alt="" />
<img src="https://pic4.zhimg.com/80/v2-667d48338cbc0c5095b7ab25ae7050ac.png" alt="å¯¼å…¥æˆåŠŸ" /></p>

<p><strong>Perfectï¼</strong></p>

<p>ç‚¹å‡»å®Œç¾</p>

<p>è‡³æ­¤ï¼Œé€‚é…å·¥ä½œå·²ç»å®Œæˆäº†</p>

<p>åç­‰å®¡æ ¸é€šè¿‡ä¸Šçº¿</p>

<p><img src="https://pic4.zhimg.com/80/v2-c6ea8cbf0f8b1627d5fb2c288abb45bf.png" alt="" /></p>
:ET